<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <title>qrcode-game扫码游戏平台</title>
   <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
   <meta name="apple-mobile-web-app-status-bar-style" content="black">
   <meta name="apple-mobile-web-app-capable" content="yes">
   <meta name="format-detection" content="telephone=no">
   <script type="text/javascript" src="/static/admin/lib/layui/layui.js"></script>
   <script type="text/javascript" src="/static/admin/js/jquery.min.js"></script>
   <script src="/static/admin/js/decimal.js"></script>
   <link rel="stylesheet" href="/static/admin/css/oksub.css" media="all"/>
</head>
<body class="ok-body-scroll console">
<div class="ok-body home">
	<!-- 头数据 -->
   <div class="layui-row layui-col-space15">
      <div class="layui-col-xs6 layui-col-md3">
         <div class="layui-card">
            <div class="ok-card-body">
               <div class="img-box" ok-pc-in-show>
                  <img src="/static/admin/images/home-01.png" alt="none"/>
               </div>
               <div class="cart-r">
                  <div class="stat-text verifying-num">60</div>
                  <div class="stat-heading">核销总数(元)</div>
               </div>
            </div>
         </div>
      </div>

      <div class="layui-col-xs6 layui-col-md3">
         <div class="layui-card ">
            <div class="ok-card-body">
               <div class="img-box" ok-pc-in-show>
                  <img src="/static/admin/images/home-02.png" alt="none"/>
               </div>
               <div class="cart-r">
                  <div class="stat-text user-num">0</div>
                  <div class="stat-heading">有效用户</div>
               </div>
            </div>
         </div>
      </div>

      <div class="layui-col-xs6 layui-col-md3">
         <div class="layui-card">
            <div class="ok-card-body">
               <div class="img-box" ok-pc-in-show>
                  <img src="/static/admin/images/home-03.png" alt="none"/>
               </div>
               <div class="cart-r">
                  <div class="stat-text agent-num">0</div>
                  <div class="stat-heading">有效代理团队</div>
               </div>
            </div>
         </div>
      </div>

      <div class="layui-col-xs6 layui-col-md3">
         <div class="layui-card">
            <div class="ok-card-body">
               <div class="img-box" ok-pc-in-show>
                  <img src="/static/admin/images/home-04.png" alt="none"/>
               </div>
               <div class="cart-r">
                  <div class="stat-text shop-num">0</div>
                  <div class="stat-heading">有效店铺</div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <div class="layui-row layui-col-space15">
		<div class="layui-col-xs6 layui-col-md6">
			<div class="layui-card">
				<div class="layui-card-header">
					<div class="ok-card-title">生成二维码测试</div>
				</div>
				<div class="ok-card-body">
					<form class="layui-form"  action="">
						<div class="layui-form-item layui-row" >
							<label class="layui-form-label">URL</label>
							<div class="layui-input-block ">
								<input type="text" name="test_url" lay-verify="required"  placeholder="请输入" autocomplete="off" class="layui-input">
							</div>
						</div>
						<div class="layui-form-item layui-row">
						<div class="layui-input-block">
							<button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
							<button type="reset" class="layui-btn layui-btn-primary">重置</button>
						</div>
						</div>
					</form>
					<div id = 'qrcode_field' style="text-align: center">

					</div>
				</div>
			</div>

		</div>
   </div>

</div>
</body>
</html>

<script>

"use strict";
layui.use(["okUtils", "table", "countUp", "okMock"], function () {
    var countUp = layui.countUp;
    var $ = layui.jquery;

    /**
     * 头数据
     */
    function get_index_sum(){
		return new Promise((resolve,reject)=>{
			$.ajax({
			url     : '/data/welcome_sum_view',
			type    : "GET",
			dataType: "json",
			success:function(result){			
				resolve(result)
			},
			error:function(err){
				console.error(err)
				reject(err)
			}
		})
		})
    }
    function statText() {
        get_index_sum()
        .then(resolve=>{
			let verifying_num = (new Decimal(resolve[0].verifying_sum).div(100).toNumber());
			let user_num = resolve[0].count_sys_user;
			let agent_num = resolve[0].count_agent;
			let shop_num = resolve[0].count_shop;

            $(".verifying-num").text(verifying_num);
            $(".user-num").text(user_num);
            $(".agent-num").text(agent_num);  
            $(".shop-num").text(shop_num);  

            var elem_nums = $(".stat-text");
            elem_nums.each(function(i, j) {
                !new countUp({
                    target: j,
                }).start();
            });
        })
        
    }
	statText();
});	

layui.use(['form'], function(){
	var form = layui.form;
	form.on('submit(formDemo)', function(data){
	layer.open({
		type: 1, 
		content:`<img src=/api/qrcode/test_qrcode?test_url=${data.field.test_url}&t=${Math.random()} alt='测试二维码'>`//这里content是一个普通的String
	});
	return false;
	});
});
	
</script>


















